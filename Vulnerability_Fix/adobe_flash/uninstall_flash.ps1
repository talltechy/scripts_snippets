# Uninstall all versions of Adobe Flash Player

# Get list of installed Adobe Flash Player versions
$flashPlayers = Get-CimInstance -Query "SELECT * FROM Win32_Product WHERE Name LIKE 'Adobe Flash Player%'"

foreach ($flashPlayer in $flashPlayers) {
    # Uninstall each version
    $flashPlayer.Uninstall()
}

# Additional cleanup if necessary
Remove-Item -Path "C:\Windows\System32\Macromed\Flash" -Recurse -Force -ErrorAction SilentlyContinue
Remove-Item -Path "C:\Windows\SysWOW64\Macromed\Flash" -Recurse -Force -ErrorAction SilentlyContinue